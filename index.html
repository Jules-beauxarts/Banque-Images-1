<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Galerie Interactive Plein Écran</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
      font-family: sans-serif;
      background: #f0f0f0;
    }

    .gallery {
      display: grid;
      gap: 4px;
      width: 100vw;
      height: 100vh;
      justify-content: center;
      align-content: center;
    }

    .gallery img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: white;
      transition: transform 0.3s;
    }

    .gallery img.enlarged {
      transform: scale(1.2);
      z-index: 10;
    }
  </style>
</head>
<body>

  <div class="gallery" id="gallery"></div>

  <script>
    const totalImages = 217;
    const padding = 4; // marge entre images

    function padNumber(num, size) {
      let s = num + "";
      while (s.length < size) s = "0" + s;
      return s;
    }

    function calculateGrid() {
      const screenW = window.innerWidth;
      const screenH = window.innerHeight;

      let bestCols = 1;
      let bestSize = 0;

      // On teste différents nombres de colonnes pour voir ce qui remplit au mieux l'écran
      for (let cols = 1; cols <= totalImages; cols++) {
        const rows = Math.ceil(totalImages / cols);
        const imageW = (screenW - (cols - 1) * padding) / cols;
        const imageH = (screenH - (rows - 1) * padding) / rows;
        const size = Math.min(imageW, imageH);

        if (size > bestSize) {
          bestSize = size;
          bestCols = cols;
        }
      }

      return bestCols;
    }

    function loadGallery() {
      const gallery = document.getElementById('gallery');
      gallery.innerHTML = ''; // nettoyer avant de recharger
      const columns = calculateGrid();
      const rows = Math.ceil(totalImages / columns);

      gallery.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;
      gallery.style.gridTemplateRows = `repeat(${rows}, 1fr)`;

      const imagePaths = [];
      for (let i = 1; i <= totalImages; i++) {
        let folder;
        if (i <= 100) folder = 'Site-Banque-Images-1';
        else if (i <= 200) folder = 'Site-Banque-Images-2';
        else folder = 'Site-Banque-Images-3';

        const numberStr = padNumber(i, 5);
        const filename = `Site-Image-${numberStr}.jpg`;
        imagePaths.push(`${folder}/${filename}`);
      }

      const shuffled = imagePaths.sort(() => Math.random() - 0.5);

      shuffled.forEach((path, index) => {
        const img = document.createElement('img');
        img.src = path;
        img.alt = `Image ${index + 1}`;
        gallery.appendChild(img);
      });

      const images = Array.from(gallery.getElementsByTagName('img'));

      gallery.addEventListener('mouseover', (e) => {
        if (e.target.tagName === 'IMG') {
          images.forEach(img => img.classList.remove('enlarged'));

          const hovered = e.target;
          hovered.classList.add('enlarged');

          const others = images.filter(img => img !== hovered);
          const randoms = others.sort(() => 0.5 - Math.random()).slice(0, 3);
          randoms.forEach(img => img.classList.add('enlarged'));
        }
      });

      gallery.addEventListener('mouseout', () => {
        images.forEach(img => img.classList.remove('enlarged'));
      });
    }

    window.addEventListener('resize', loadGallery);
    window.addEventListener('load', loadGallery);
  </script>
</body>
</html>